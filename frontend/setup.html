<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SmartFarm Nexus | Add Monitor</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">

  <!-- Leaflet CSS for the map -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <link rel="stylesheet" href="styles/setup.css">
</head>
<body>

<!-- Theme Toggle Button -->
<button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
  <i class="fas fa-moon moon-icon"></i>
  <i class="fas fa-sun sun-icon"></i>
</button>

<!-- Vine Decorations -->
<svg class="vine-decoration vine-top-left" width="200" height="200" viewBox="0 0 200 200">
  <path class="vine-path" d="M 2 100 C 2 2, 100 2, 100 100 S 198 2, 198 100"/>
</svg>
<svg class="vine-decoration vine-bottom-right" width="200" height="200" viewBox="0 0 200 200">
  <path class="vine-path" d="M 2 100 C 2 2, 100 2, 100 100 S 198 2, 198 100"/>
</svg>

<div class="monitor-form-container">
  <div class="form-header">
    <h1><i class="fas fa-seedling"></i> New Monitoring Setup</h1>
    <div id="step-indicator">Step 1 of 4</div>
  </div>

  <div class="form-content">
    <!-- Step 1: Select Plant Image -->
    <div class="form-step active" data-step="1">
      <h2 class="step-title"><i class="fas fa-camera"></i> Select Your Plant</h2>
      <p class="step-subtitle">Choose an image source to identify the plant you want to monitor.</p>
      <div class="image-selection-options">
        <div class="option-card" data-source="upload">
          <i class="fas fa-upload"></i>
          <p>Upload Image</p>
        </div>
        <div class="option-card" data-source="esp32">
          <i class="fas fa-camera"></i>
          <p>Use ESP32 Cam</p>
        </div>
        <div class="option-card" data-source="web">
          <i class="fas fa-globe"></i>
          <p>Search on Web</p>
        </div>
      </div>

      <!-- Web Search Container -->
      <div class="web-search-container" id="web-search-container">
        <input type="text" class="search-input" id="web-search-input" placeholder="Search for plant images...">
        <button class="search-btn" id="web-search-btn">
          <i class="fas fa-search"></i>
        </button>
      </div>

      <!-- Image Drop Zone -->
      <div class="image-drop-zone" id="image-drop-zone">
        <i class="fas fa-image" style="font-size: 3rem; color: var(--text-secondary); margin-bottom: 1rem;"></i>
        <p>Your selected image will appear here</p>
      </div>

      <input type="file" id="image-upload-input" accept="image/*" style="display: none;">
    </div>

    <!-- Step 2: Confirm Plant & Conditions -->
    <div class="form-step" data-step="2">
      <h2 class="step-title"><i class="fas fa-leaf"></i> Growing Conditions</h2>
      <p class="step-subtitle">These are the ideal conditions for a healthy <strong>Tomato Plant</strong>. Review and proceed.</p>
      <div class="conditions-grid">
        <div class="condition-item">
          <h4><i class="fas fa-thermometer-half"></i> Temperature</h4>
          <p>21-24 °C</p>
        </div>
        <div class="condition-item">
          <h4><i class="fas fa-tint"></i> Humidity</h4>
          <p>60-70%</p>
        </div>
        <div class="condition-item">
          <h4><i class="fas fa-seedling"></i> Soil Moisture</h4>
          <p>50-60%</p>
        </div>
        <div class="condition-item">
          <h4><i class="fas fa-sun"></i> Light</h4>
          <p>12-16 hours/day</p>
        </div>
      </div>
    </div>

    <!-- Step 3: Location & Environment -->
    <div class="form-step" data-step="3">
      <h2 class="step-title"><i class="fas fa-map-marker-alt"></i> Location & Environment</h2>
      <p class="step-subtitle">Pinpoint the location on the map and select the growing environment.</p>

      <div class="map-search-container">
        <input type="text" class="map-search-input" id="map-search-input" placeholder="Search for a location...">
        <button class="map-search-btn" id="map-search-btn">
          <i class="fas fa-search"></i>
        </button>
      </div>

      <div id="map"></div>
      <div class="location-info">
        Selected Location: <strong id="location-text">Not selected</strong>
      </div>
      <div class="environment-options">
        <input type="radio" name="environment" id="env-guided" class="env-radio" value="Guided">
        <label for="env-guided" class="env-label">
          <i class="fas fa-warehouse"></i> Guided (Greenhouse)
        </label>
        <input type="radio" name="environment" id="env-unguided" class="env-radio" value="Unguided">
        <label for="env-unguided" class="env-label">
          <i class="fas fa-sun"></i> Unguided (Open Field)
        </label>
      </div>
    </div>

    <!-- Step 4: Summary & Confirmation -->
    <div class="form-step" data-step="4">
      <h2 class="step-title"><i class="fas fa-clipboard-check"></i> Final Confirmation</h2>
      <p class="step-subtitle">Please review all the details below before starting the monitoring process.</p>
      <div class="summary-grid">
        <img src="https://placehold.co/300x300/22c55e/FFF?text=Plant" alt="Plant to be monitored" id="summary-image" class="summary-image">
        <div class="summary-details">
          <div class="summary-item"><strong>Plant Type:</strong> <span id="summary-plant">Tomato</span></div>
          <div class="summary-item"><strong>Location:</strong> <span id="summary-location">Not Selected</span></div>
          <div class="summary-item"><strong>Environment:</strong> <span id="summary-environment">Not Selected</span></div>
          <div class="summary-item"><strong>Weather:</strong> <span>Sunny, 28°C</span></div>
          <div class="summary-item"><strong>Initial Temp:</strong> <span>22°C</span></div>
          <div class="summary-item"><strong>Initial Humidity:</strong> <span>65%</span></div>
        </div>
      </div>
    </div>
  </div>

  <div class="form-footer">
    <button class="btn btn-secondary" id="prev-btn" disabled>Previous</button>
    <button class="btn btn-primary" id="next-btn" disabled>Next</button>
  </div>
</div>

<!-- ESP32 Loading Screen -->
<div id="esp32-loading-screen">
  <div class="loading-bee-container">
    <div class="loading-camera-frame"></div>
    <div class="loading-bee">
      <div class="loading-bee-body"></div>
      <div class="loading-bee-wings">
        <div class="loading-wing left"></div>
        <div class="loading-wing right"></div>
      </div>
    </div>
    <div class="loading-particles">
      <div class="loading-particle"></div>
      <div class="loading-particle"></div>
      <div class="loading-particle"></div>
      <div class="loading-particle"></div>
    </div>
  </div>

  <div class="loading-text">
    <div class="loading-title">ESP32 Camera</div>
    <div class="loading-subtitle">Capturing your plant image...</div>

    <div class="loading-progress">
      <div class="loading-progress-bar" id="loading-progress-bar"></div>
    </div>

    <div class="loading-status">
      <span id="loading-status-text">Connecting to camera</span>
      <span class="loading-dots"></span>
    </div>
  </div>
</div>

<!-- Bee Delivery Animation Container -->
<div id="bee-delivery-container">
  <div id="delivery-bee">
    <div class="bee-realistic">
      <div class="bee-body"></div>
      <div class="bee-wings">
        <div class="wing left"></div>
        <div class="wing right"></div>
      </div>
    </div>
    <img src="" id="bee-carried-image" alt="Plant Image">
  </div>
</div>

<!-- Leaflet JS for the map -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

<script src="js/setup.js"></script>
</body>
</html>